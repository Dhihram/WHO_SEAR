axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25)
) +
theme_minimal(base_size = 14)
p
# Create the bar chart
p <- ggplot(add_cases, aes(x = date, y = cases)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = cases), vjust = -0.5, size = 7) +
scale_x_date(date_labels = "%d %b %Y") +
labs(title = "Total Number of ADD Cases Reported",
x = "Date",
y = "Number of Cases",
axis.text.x = element_text(angle = 0, hjust = 0.5, size = 25),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25)
) +
theme_minimal(base_size = 14)
p
# Create the bar chart
p <- ggplot(add_cases, aes(x = date, y = cases)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = cases), vjust = -0.5, size = 7) +
scale_x_date(date_labels = "%d %b %Y") +
labs(title = "Total Number of ADD Cases Reported",
x = "Date",
y = "Number of Cases",
axis.text.x = element_text(angle = 0, hjust = 0.5, size = 25),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25)
) +
theme_minimal()
p
# Create the bar chart
p <- ggplot(add_cases, aes(x = date, y = cases)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = cases), vjust = -0.5, size = 7) +
scale_x_date(date_labels = "%d %b %Y") +
theme_minimal()+
labs(title = "Total Number of ADD Cases Reported",
x = "Date",
y = "Number of Cases",
axis.text.x = element_text(angle = 0, hjust = 0.5, size = 25),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25)
) +
p
setwd("C:/Users/dhihr/Downloads")
# Create the bar chart
p <- ggplot(add_cases, aes(x = date, y = cases)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = cases), vjust = -0.5, size = 7) +
scale_x_date(date_labels = "%d %b %Y") +
theme_minimal()+
labs(title = "Total Number of ADD Cases Reported",
x = "Date",
y = "Number of Cases",
axis.text.x = element_text(angle = 0, hjust = 0.5, size = 25),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25)
) +
p
# Create the bar chart
p <- ggplot(add_cases, aes(x = date, y = cases)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = cases), vjust = -0.5, size = 7) +
scale_x_date(date_labels = "%d %b %Y") +
theme_minimal()+
labs(title = "Total Number of ADD Cases Reported",
x = "Date",
y = "Number of Cases",
axis.text.x = element_text(angle = 0, hjust = 0.5, size = 25),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25)
)
p
# Create the bar chart
p <- ggplot(add_cases, aes(x = date, y = cases)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = cases), vjust = -0.5, size = 7) +
scale_x_date(date_labels = "%d %b %Y") +
theme_minimal()+
labs(title = "Total Number of ADD Cases Reported",
x = "Date",
y = "Number of Cases",
axis.text.x = element_text(angle = 0, hjust = 0.5, size = 25),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25)
)
p
# Create the bar chart
p <- ggplot(add_cases, aes(x = date, y = cases)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = cases), vjust = -0.5, size = 7) +
scale_x_date(date_labels = "%d %b %Y") +
theme_minimal()+
labs(title = "Total Number of ADD Cases Reported",
x = "Date",
y = "Number of Cases",
axis.text.x = element_text(angle = 0, hjust = 0.5, size = 30),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25)
)
p
# Create the bar chart
p <- ggplot(add_cases, aes(x = date, y = cases)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = cases), vjust = -0.5, size = 7) +
scale_x_date(date_labels = "%d %b %Y") +
theme_minimal()+
labs(title = "Total Number of ADD Cases Reported",
x = "Date",
y = "Number of Cases",
axis.text.x = element_text(angle = 0, hjust = 0.5, size = 40),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25)
)
p
# Create the bar chart
p <- ggplot(add_cases, aes(x = date, y = cases)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = cases), vjust = -0.5, size = 7) +
scale_x_date(date_labels = "%d %b %Y") +
theme_minimal()+
labs(title = "Total Number of ADD Cases Reported",
x = "Date",
y = "Number of Cases",
axis.text.x = element_text(size = 16),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25)
)
p
# Create the bar chart
p <- ggplot(add_cases, aes(x = date, y = cases)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = cases), vjust = -0.5, size = 7) +
scale_x_date(date_labels = "%d %b %Y") +
theme_minimal(base_size = 14)+
labs(title = "Total Number of ADD Cases Reported",
x = "Date",
y = "Number of Cases",
axis.text.x = element_text(size = 16),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25)
)
p
# Create the bar chart
p <- ggplot(add_cases, aes(x = date, y = cases)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = cases), vjust = -0.5, size = 7) +
scale_x_date(date_labels = "%d %b %Y") +
theme_minimal(base_size = 14)+
labs(title = "Total Number of ADD Cases Reported",
x = "Date",
y = "Number of Cases",
axis.text.x = element_text(size = 19),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25)
)
p
# Create the bar chart
p <- ggplot(add_cases, aes(x = date, y = cases)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = cases), vjust = -0.5, size = 7) +
scale_x_date(date_labels = "%d %b %Y") +
theme_minimal(base_size = 16)+
labs(title = "Total Number of ADD Cases Reported",
x = "Date",
y = "Number of Cases",
axis.text.x = element_text(size = 19),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25)
)
p
setwd("C:/Users/dhihr/Downloads")
ggsave("ADD.png", plot = p, width = 12, height = 9, units = "in", dpi = 300)
ggsave("ADD.png", plot = p, width = 10, height = 5, units = "in", dpi = 300)
# Create the bar chart
p <- ggplot(add_cases, aes(x = date, y = cases)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = cases), vjust = -0.5, size = 4) +
scale_x_date(date_labels = "%d %b %Y") +
theme_minimal(base_size = 16)+
labs(title = "Total Number of ADD Cases Reported",
x = "Date",
y = "Number of Cases",
axis.text.x = element_text(size = 19),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25)
)
p
setwd("C:/Users/dhihr/Downloads")
ggsave("ADD.png", plot = p, width = 10, height = 5, units = "in", dpi = 300)
# Create the bar chart
p <- ggplot(add_cases, aes(x = date, y = cases)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = cases), vjust = -0.5, size = 5) +
scale_x_date(date_labels = "%d %b %Y") +
theme_minimal(base_size = 16)+
labs(title = "Total Number of ADD Cases Reported",
x = "Date",
y = "Number of Cases",
axis.text.x = element_text(size = 19),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25)
)
p
setwd("C:/Users/dhihr/Downloads")
ggsave("ADD.png", plot = p, width = 10, height = 5, units = "in", dpi = 300)
setwd("C:/Users/dhihr/Downloads")
ggsave("ADD.png", plot = p, width = 10, height = 6, units = "in", dpi = 300)
# Create the bar chart
p <- ggplot(add_cases, aes(x = date, y = cases)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = cases), vjust = -0.5, size = 5) +
scale_x_date(date_labels = "%d %b %Y") +
theme_minimal(base_size = 19)+
labs(title = "Total Number of ADD Cases Reported",
x = "Date",
y = "Number of Cases",
axis.text.x = element_text(size = 19),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25)
)
p
setwd("C:/Users/dhihr/Downloads")
ggsave("ADD.png", plot = p, width = 10, height = 6, units = "in", dpi = 300)
# Create the bar chart
p <- ggplot(add_cases, aes(x = date, y = cases)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = cases), vjust = -0.5, size = 5) +
scale_x_date(date_labels = "%d %b %Y") +
scale_y_continuous(limits = c(0, 700)) +
labs(
title = "Total Number of ADD Cases Reported",
x = "Date",
y = "Number of Cases"
) +
theme_minimal(base_size = 19) +
theme(
axis.text.x = element_text(size = 19),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25)
)
p
# Create the bar chart
p <- ggplot(add_cases, aes(x = date, y = cases)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = cases), vjust = -0.5, size = 5) +
scale_x_date(date_labels = "%d %b %Y") +
scale_y_continuous(limits = c(0, 700)) +
labs(
title = "Total Number of ADD Cases Reported",
x = "Date",
y = "Number of Cases"
) +
theme_minimal(base_size = 19) +
theme(
axis.text.x = element_text(size = 18),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25)
)
p
setwd("C:/Users/dhihr/Downloads")
ggsave("ADD.png", plot = p, width = 10, height = 6, units = "in", dpi = 300)
# Create the bar chart
p <- ggplot(add_cases, aes(x = date, y = cases)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = cases), vjust = -0.5, size = 6) +
scale_x_date(date_labels = "%d %b %Y") +
scale_y_continuous(limits = c(0, 700)) +
labs(
title = "Total Number of ADD Cases Reported",
x = "Date",
y = "Number of Cases"
) +
theme_minimal(base_size = 19) +
theme(
axis.text.x = element_text(size = 18),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25)
)
p
setwd("C:/Users/dhihr/Downloads")
ggsave("ADD.png", plot = p, width = 10, height = 6, units = "in", dpi = 300)
ggsave("ADD.jpg", plot = p, width = 10, height = 6, units = "in", dpi = 300)
# Create the bar chart
p <- ggplot(add_cases, aes(x = date, y = cases)) +
geom_col(fill = "steelblue") +
geom_text(aes(label = cases), vjust = -0.5, size = 7) +
scale_x_date(date_labels = "%d %b %Y") +
scale_y_continuous(limits = c(0, 700)) +
labs(
title = "Total Number of ADD Cases Reported",
x = "Date",
y = "Number of Cases"
) +
theme_minimal(base_size = 19) +
theme(
axis.text.x = element_text(size = 18),
axis.title.x = element_text(size = 25),
axis.title.y = element_text(size = 25)
)
p
setwd("C:/Users/dhihr/Downloads")
ggsave("ADD.jpg", plot = p, width = 10, height = 6, units = "in", dpi = 300)
library(sf)
library("sf")
fl_accidents %<>%
st_as_sf(coords = c("longitud", "latitude")) %>%
st_sf(crs = 4326)
library(tidyverse)
fl_accidents %<>%
st_as_sf(coords = c("longitud", "latitude")) %>%
st_sf(crs = 4326)
library(leaflet)
leaflet() %>%
addTiles() %>%
setView(lng = -3.7, lat = 40.4, zoom = 5) %>%
addMarkers(lng = -3.7, lat = 40.4)
leaflet() %>%
addTiles() %>%
setView(lng = -3.7, lat = 40.4, zoom = 5) %>%
addMarkers(lng = c(-3.7, -3.75), lat = c(40.4,40.8))
leaflet() %>%
addTiles() %>%
setView(lng = -3.7, lat = 40.4, zoom = 5) %>%
addMarkers(lng = c(-3.7, -3.75), lat = c(40.4,40.8), label = c('C','A'))
library(tidyverse)
library(dplyr)
library(lubridate)
library(MMWRweek)
data <- read.csv('https://xmart-api-public.who.int/FLUMART/VIW_FNT?$format=csv') %>%
filter(WHOREGION == 'SEAR')
flu_dat <- data
flu_dat_agg <- flu_dat %>%
mutate(
VIC = rowSums(select(., BVIC_NODEL, BVIC_DELUNK, BVIC_3DEL, BVIC_2DEL), na.rm = TRUE),
MMWR_WEEKSTARTDATE = as.Date(MMWR_WEEKSTARTDATE)
) %>%
group_by(COUNTRY_AREA_TERRITORY, MMWR_WEEKSTARTDATE) %>%
summarise(
flu_all = sum(INF_ALL, na.rm = TRUE),
flu_vic = sum(VIC, na.rm = TRUE),
flu_ah5 = sum(AH5, na.rm = TRUE),
flu_ah3 = sum(AH3, na.rm = TRUE),
flu_ah1n12009 = sum(AH1N12009, na.rm = TRUE),
flu_ah1 = sum(AH1, na.rm = TRUE),
flu_anot = sum(ANOTSUBTYPED, na.rm = TRUE),
flu_bnot = sum(BNOTDETERMINED, na.rm = TRUE),
flu_byam = sum(BYAM, na.rm = TRUE),
specimen = sum(SPEC_PROCESSED_NB, na.rm = TRUE),
MMWR_WEEK = last(MMWR_WEEK),
COUNTRY_AREA_TERRITORY = last(COUNTRY_AREA_TERRITORY),
.groups = "drop"
) %>%
mutate(
pos_rate = round(ifelse(specimen > 0, (flu_all / specimen) * 100, 0), 2),
across(where(is.numeric), ~replace(., is.infinite(.) | is.na(.), 0)),
COUNTRY_AREA_TERRITORY = ifelse(COUNTRY_AREA_TERRITORY == "Democratic People's Republic of Korea", "DPR Korea", COUNTRY_AREA_TERRITORY))
flu_dat_agg
grouping_flu <- flu_dat %>%
mutate(
VIC = rowSums(select(., BVIC_NODEL, BVIC_DELUNK, BVIC_3DEL, BVIC_2DEL), na.rm = TRUE),
MMWR_WEEKSTARTDATE = as.Date(MMWR_WEEKSTARTDATE)
) %>%
group_by(MMWR_WEEKSTARTDATE) %>%
summarise(
COUNTRY_AREA_TERRITORY = 'All Country',
flu_all = sum(INF_ALL, na.rm = TRUE),
flu_vic = sum(VIC, na.rm = TRUE),
flu_ah5 = sum(AH5, na.rm = TRUE),
flu_ah3 = sum(AH3, na.rm = TRUE),
flu_ah1n12009 = sum(AH1N12009, na.rm = TRUE),
flu_ah1 = sum(AH1, na.rm = TRUE),
flu_anot = sum(ANOTSUBTYPED, na.rm = TRUE),
flu_bnot = sum(BNOTDETERMINED, na.rm = TRUE),
flu_byam = sum(BYAM, na.rm = TRUE),
specimen = sum(SPEC_PROCESSED_NB, na.rm = TRUE),
MMWR_WEEK = last(MMWR_WEEK),
COUNTRY_AREA_TERRITORY = last(COUNTRY_AREA_TERRITORY),
.groups = "drop"
) %>% select(COUNTRY_AREA_TERRITORY, everything()) %>%
mutate(
pos_rate = round(ifelse(specimen > 0, (flu_all / specimen) * 100, 0), 2),
across(where(is.numeric), ~replace(., is.infinite(.) | is.na(.), 0))
)
flu_dat_agg <- rbind(flu_dat_agg, grouping_flu)
flu_dat_full <- expand.grid(
COUNTRY_AREA_TERRITORY = unique(flu_dat_agg$COUNTRY_AREA_TERRITORY),
MMWR_WEEKSTARTDATE = seq(min(flu_dat_agg$MMWR_WEEKSTARTDATE), max(flu_dat_agg$MMWR_WEEKSTARTDATE), by = "week")
) %>%
left_join(flu_dat_agg, by = c("COUNTRY_AREA_TERRITORY", "MMWR_WEEKSTARTDATE")) %>%
mutate(across(where(is.numeric), ~replace_na(.x, 0))) %>%
as.data.frame()
flu_dat_full <- flu_dat_full %>%
mutate(across(where(is.numeric), ~replace_na(.x, 0))) %>% mutate(MMWR_WEEK = MMWRweek(flu_dat_full$MMWR_WEEKSTARTDATE)$MMWRweek)
flu_colors <- c(
"flu_ah1"        = "#C9C9C9",
"flu_ah1n12009"  = "#8FE6E7",
"flu_ah3"        = "#00A1D5",
"flu_ah5"        = "#74F907",
"flu_anot"       = "#104f82",
"flu_bnot"       = "#9c4b30",
"flu_byam"       = "#FFB86D",
"flu_vic"        = "#F79700"
)
flu_labels <- c(
"flu_ah1"        = "A(H1)",
"flu_ah1n12009"  = "A(H1N1)pdm2009",
"flu_ah3"        = "A(H3)",
"flu_ah5"        = "A(H5)",
"flu_anot"       = "A not Subtyped",
"flu_bnot"       = "B not Determined",
"flu_byam"       = "B Yamagata",
"flu_vic"        = "B Victoria"
)
flu_long <- flu_dat_full %>%
select(COUNTRY_AREA_TERRITORY, MMWR_WEEKSTARTDATE, pos_rate,
flu_ah1, flu_ah3, flu_ah5, flu_ah1n12009, flu_byam, flu_vic, flu_anot, flu_bnot) %>%
pivot_longer(
cols = starts_with("flu_"),
names_to = "Flu_Type",
values_to = "Cases"
)
flu_long <- flu_long %>%
mutate(Label = flu_labels[Flu_Type],
Color = flu_colors[Flu_Type])
setwd("~/GitHub/WHO_SEAR/Dat")
write.csv(flu_dat_full, "flu_dat_full.csv", row.names = FALSE)
write.csv(flu_long, "flu_long.csv", row.names = FALSE)
data <- read.csv('https://xmart-api-public.who.int/FLUMART/VIW_FID_EPI?$format=csv') %>%
filter(WHOREGION == 'SEAR')
data <- read.csv('https://xmart-api-public.who.int/FLUMART/VIW_FID_EPI?$format=csv') %>%
filter(WHOREGION == 'SEAR')
#alt opening
#setwd("C:/Users/dhihr/OneDrive/bahan who/kerjaan who/influenza")
#data <- read.csv('VIW_FID_EPI.csv') %>%
#  filter(WHOREGION == 'SEAR')
data <- data %>% filter(AGEGROUP_CODE == 'ALL')
data <- data %>% select(COUNTRY_AREA_TERRITORY, MMWR_WEEKSTARTDATE,ILI_CASE, ILI_OUTPATIENTS, SARI_CASE, SARI_INPATIENTS)
data <- data %>%
mutate(
ili_1000 = round(ifelse(ILI_OUTPATIENTS > 0, (ILI_CASE / ILI_OUTPATIENTS) * 100, 0), 2),
sari_100= round(ifelse(SARI_INPATIENTS > 0, (SARI_CASE / SARI_INPATIENTS) * 100, 0), 2),
across(where(is.numeric), ~replace(., is.infinite(.) | is.na(.), 0)),
COUNTRY_AREA_TERRITORY = ifelse(COUNTRY_AREA_TERRITORY == "Democratic People's Republic of Korea", "DPR Korea", COUNTRY_AREA_TERRITORY))
data$MMWR_WEEKSTARTDATE <- as.Date(data$MMWR_WEEKSTARTDATE)
grouping_data <- data %>%
group_by(MMWR_WEEKSTARTDATE) %>%
summarise(
COUNTRY_AREA_TERRITORY = 'All Country',
ILI_CASE = sum(ILI_CASE, na.rm = TRUE),
ILI_OUTPATIENTS = sum(ILI_OUTPATIENTS, na.rm = TRUE),
SARI_CASE = sum(SARI_CASE, na.rm = TRUE),
SARI_INPATIENTS = sum(SARI_INPATIENTS, na.rm = TRUE)) %>%
mutate(
ili_1000 = round(ifelse(ILI_OUTPATIENTS > 0, (ILI_CASE / ILI_OUTPATIENTS) * 100, 0), 2),
sari_100= round(ifelse(SARI_INPATIENTS > 0, (SARI_CASE / SARI_INPATIENTS) * 100, 0), 2),
across(where(is.numeric), ~replace(., is.infinite(.) | is.na(.), 0)))
fluid_dat_agg <- rbind(data, grouping_data)
fluid_dat_full <- expand.grid(
COUNTRY_AREA_TERRITORY = unique(fluid_dat_agg$COUNTRY_AREA_TERRITORY),
MMWR_WEEKSTARTDATE = seq(min(fluid_dat_agg$MMWR_WEEKSTARTDATE), max(fluid_dat_agg$MMWR_WEEKSTARTDATE), by = "week")
) %>%
left_join(fluid_dat_agg, by = c("COUNTRY_AREA_TERRITORY", "MMWR_WEEKSTARTDATE")) %>%
mutate(across(where(is.numeric), ~replace_na(.x, 0))) %>%
as.data.frame()
fluid_dat_full <- fluid_dat_full %>%
mutate(across(where(is.numeric), ~replace_na(.x, 0))) %>% mutate(MMWR_WEEK = MMWRweek(fluid_dat_full$MMWR_WEEKSTARTDATE)$MMWRweek)
setwd("~/GitHub/WHO_SEAR/Dat")
write.csv(fluid_dat_full, "fluid_dat_full.csv", row.names = FALSE)
View(flu_dat_agg)
View(flu_dat_full)
View(flu_dat_full)
library(RSelenium)
library(tidyverse)
# Start RSelenium (adjust chromever to your installed version if needed)
rD <- rsDriver(browser = "chrome", chromever = "104.0.5112.79", port = 4850L,
verbose = FALSE, phantomver = NULL)
remDr <- rD$client
# Navigate to the WHO Disease Outbreak News page
remDr$navigate("https://www.who.int/emergencies/disease-outbreak-news")
Sys.sleep(10)  # Give time for page and JS to load
# Scroll down to trigger content loading
for (i in 1:5) {
remDr$executeScript("window.scrollTo(0, document.body.scrollHeight);")
Sys.sleep(2)
}
# Get all visible outbreak title links (they include date + title)
headline_links <- remDr$findElements(using = "css selector", value = "a[href*='/emergencies/disease-outbreak-news/item']")
# Extract text content from those links
titles_raw <- sapply(headline_links, function(el) el$getElementText()[[1]])
outbreak_df <- tibble(raw = titles_raw) %>%
mutate(
clean = str_remove(raw, "^Disease Outbreak News\\n"),
date = str_extract(clean, "^\\d{1,2} \\w+ \\d{4}"),
title = str_remove(clean, "^\\d{1,2} \\w+ \\d{4} \\|\\s*")
) %>%
separate(title, into = c("disease", "country"), sep = " - | – ", extra = "merge", fill = "right") %>%
select(date, disease, country)
print(outbreak_df)
outbreak_df <- outbreak_df %>%
filter(str_detect(date, "May 2025"))
# Show the result
print(outbreak_df)
# Optional: Save to CSV
setwd("~/GitHub/WHO_SEAR/Dat")
write_csv(outbreak_df, "who_outbreak.csv")
# Clean up session
remDr$close()
rD$server$stop()
